<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../assets/favicon.png" type="image/x-icon">
    <script src="../scripts/three.min.js"></script>
    <script src="../scripts/jquery.min.js"></script>
    <script src="../scripts/typed.min.js"></script>

    <script src="../scripts/background.js"></script>
    <script src="../scripts/functions.js"></script>
    <script src="../scripts/articles.js"></script>
    <link rel="stylesheet" href="../styles/index.css">

    <title>CyberCrew | DPSSGR</title>
</head>

<body>
    <div class="header">
        <button class="headerButton clickable" onclick="window.location.href='..'">Home</button>
        <button class="headerButton clickable" onclick="window.location.href='../articles'">Articles</button>
        <button class="headerButton clickable"
            onclick="window.location.href=('https://techknow.dpssrinagar.com')">TechKnow</button>
    </div>
    <script>
        let params = new URLSearchParams(window.location.search);
        let articleName = params.get("title")
        fetch('https://backend-ddu1.onrender.com/articles')
            .then(response => response.json())
            .then(data => {
                let article = data.find((article) => article.title.split(" ").join("_") == articleName);
                let articleContainer = document.getElementById('articles');
                console.log(article)
                articleContainer.innerHTML = `
                <div class="articleCover" id="artCover" style="background-image: url(${article.imgUrl});border-top-left-radius:0.6rem;border-top-right-radius: 0.6rem;">
                <div class="blackWrapper"></div>
                <h1 id="articleTitle" class="articleTitle">${article.title}</h1>
                </div>
                <div class="articleContent">
                <div id="articleContent">${article.content}</div>
                </div>
                `;
                let meta = document.createElement('meta');
                meta.name = "description";
                meta.content = article.description;
                document.head.appendChild(meta);
                let meta2 = document.createElement('meta');
                meta2.name = "keywords";
                meta2.content = article.keywords;
                document.head.appendChild(meta2);
                let meta3 = document.createElement('meta');
                meta3.name = "author";
                meta3.content = "CyberCrew";
                document.head.appendChild(meta3);
                let meta4 = document.createElement('meta');
                meta4.name = "og:title";
                meta4.content = article.title;
                document.head.appendChild(meta4);
                let meta5 = document.createElement('meta');
                meta5.name = "og:description";
                meta5.content = article.description;
                document.head.appendChild(meta5);
                let meta6 = document.createElement('meta');
                meta6.name = "og:image";
                meta6.content = article.imgUrl;
                document.head.appendChild(meta6);
                let meta7 = document.createElement('meta');
                meta7.name = "og:url";
                meta7.content = window.location.href;
                document.head.appendChild(meta7);
                let meta8 = document.createElement('meta');
                meta8.name = "og:site_name";
                meta8.content = "CyberCrew";
                document.head.appendChild(meta9);

            });
    </script>
    <div class="p2">
        <div id="artContainer-bpage" class="articleContainer-bpage">
            <div class="articles-apage" id="articles">
                <img class="loading" src="../assets/loading.svg">
            </div>
        </div>
        <div class="wrapper">
            <div class="footer" id="footer">
                <script>
                    //I have no idea why this is not getting the full width, so for now i used this workaround
                    // TODO: Fix this
                    let elem = document.getElementById('artContainer-bpage');
                    document.getElementById('footer').style.width = `${elem.offsetWidth}px`;
                    let resize = (event) => {
                        let elem = document.getElementById('artContainer-bpage');
                        document.getElementById('footer').style.width = `${elem.offsetWidth}px`;
                    };
                    window.addEventListener('resize', resize);
                </script>
                <div class="socials footer-card">
                    <div onclick="window.open('https://github.com/cybercrew')" class="socials-circle clickable"><img
                            src="../assets/github.svg"></div>
                    <div onclick="window.open('https://www.facebook.com/dpscybercrew/')"
                        class="socials-circle clickable">
                        <img src="../assets/facebook.svg">
                    </div>
                    <div class="socials-circle clickable x"><img src="../assets/x.svg">
                    </div>
                </div>
                <div class="school-container footer-card">
                    <div class="school clickable" onclick="window.location.href=('https://dpssrinagar.com')">
                        <img src="../assets/dpslogo.png" alt="DPS Srinagar Logo">
                        <p>Visit School Website</p>
                    </div>
                </div>
                <div class="contact footer-card">
                    <div class="text">
                        <h1>Contact</h1>
                        <p>Phone: +91 1234567890</p>
                        <p>Email: cybercrew@example.com</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>

</html>